package com.examplefg.malwarechecker.Control;

import android.content.Context;
import android.content.pm.ApplicationInfo;
import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;
import android.graphics.drawable.Drawable;
import android.view.View;
import android.widget.ImageView;
import android.widget.TextView;

import androidx.recyclerview.widget.RecyclerView;

import com.examplefg.malwarechecker.R;

import butterknife.BindView;
import butterknife.ButterKnife;

public class ScannerViewHolder extends RecyclerView.ViewHolder {

    @BindView(R.id.activity_scanner_item_appIcon) ImageView appIcon;
    @BindView(R.id.activity_scanner_item_appName) TextView appName;
    @BindView(R.id.activity_scanner_item_appPackage) TextView appPackage;

    //pour le PackageManager
    Context mContext;

    //constructeur
    public ScannerViewHolder(View itemView,Context context)
    {
        super(itemView);
        ButterKnife.bind(this,itemView); //relier les vues aux variables
        this.mContext = context;
    }

    //permet de remplir les view de l'item avec les infos d'une application
    public void updateWithPackageInfo(PackageInfo packageInfo)
    {
        //get le PackageManager
        PackageManager packageManager = mContext.getPackageManager();

        //set nom du package
        appPackage.setText(packageInfo.packageName);

        try
        {
            //set nom de l'application
            ApplicationInfo appInfo = packageManager.getApplicationInfo(packageInfo.packageName,packageManager.GET_META_DATA); //info de l'app
            String appLabel = (String)packageManager.getApplicationLabel(appInfo); //extraire le nom de l'app
            appName.setText(appLabel); //set le nom de l'application

            Drawable icon = packageManager.getApplicationIcon(packageInfo.packageName); //get l'icon de l'application
            if(icon != null)
            {
                appIcon.setImageDrawable(icon);
            }
        }
        catch(Exception e)
        {
            e.printStackTrace();
        }
    }
}
